\documentclass[../../main.tex]{subfiles}

%-----------------------------------------------------------%
\begin{document}
\subsection{Feature Extraction}
\subsubsection{Pixel-By-Pixel Tagging Algorithm}
\label{sec:pixel_by_pixel}
		There were broadly two stages in the testing process:
		\begin{enumerate}
			\item An \emph{internal testing} for every single function involved in the algorithm whose test cases included some possible shapes of stars and other geometrical shapes, a list of the intermediate values of the functions and their expected outputs were calculated by \textit{hand}. \\
			The internal testing stage had a limited \textit{diversity} and was more concentrated on testing the extreme cases like a blank image and stars in the edges and corners of the image. This step did not show any variations from the expected output\footnote{Note that most test cases were designed to have integral values as an output}. \\
			The function passed all extreme cases and we moved on to the second phase to broaden the realms of testing.
			\item A \emph{simulation-based} testing which tested the algorithm as a whole where the functions were called sequentially from the algorithm's \textit{main()}. This was done against the images generated by the Sensor Model team. \\
			The simulation-based testing is based on a \textit{gaussian curve fitting} method and gives a better sense of randomness - both in terms of the intensities of pixels and the positions of centroids - combined with a more realistic depiction of an image taken in outer space. 
		\end{enumerate}

		The independant constants that were optimised during testing are as follows:
		\begin{description}
			\item [Threshold] A value one less than the minimum intensity of a pixel for it to be classified as a bright pixel
			\item [Star\_min\_pixel] A value one less than the minimum number of pixels a region of bright pixels should span to be classified as a star
			\item [Star\_max\_pixel] A value one more than the maximum number of pixels a region of bright pixels can span to be classified as a star
		\end{description}

		To decide the values of these constants, we tested the code against varying values extensively. Before we go through the results, here are the parameters that were used to quantify the results obtained.

		\begin{description}
			\item [Num\_Actual] The number of stars present in an image provided by the Sensor Model team
			\item [Num\_Identified] The number of stars in the image as identified by the algorithm
			\item [Num\_Matched] The number of stars identified that have a valid\footnote{This term isn't conventional and is used to differentiate between Num\_Identified and the star's validity as explained under set radius} counterpart in the expected output
			\item [Radial Distance] The distance between the codeâ€™s output centroid and an expected centroid
			\item [Set Radius / Allowed Radius] The upper bound of \emph{radial distance} that determines an identified star's validity
			\item [Mean\_R] As the name suggests, the mean of all the radial distances between the expected and code centroids in a given image
			\item [STD\_R] The standard deviation of all the radial distances in a given image
			\item [Max\_R] The maximum radial distance in a given image
		\end{description}

		We expect any star that is identified to have a valid counterpart according to the list of expected centroids, \textit{i.e.}, any star that is identified also gets matched. If the number of stars identified exceeds the actual number of stars in the image, we can infer that the code has picked up some \textit{false positives}. \\
		The images generated by the Sensor Model team were based on the lens and baffle model presented by the Instrumentation Subsystem. In its current iteration, we found that a \textit{Threshold} value below 5 or \textit{Star\_min\_pixel} value below 3 resulted in \textit{false positives} while \textit{Star\_min\_pixel} values above 6 had a low star identification rate. The value for \textit{Star\_max\_pixel} has not been decided yet as an image generation model that includes celestial bodies has not been coded. \\
		\begin{center}
		\begin{tabular}{ c|c|c|c|c|c }
			Threshold & Star\_min\_pixel & Num\_Id & Num\_Ac & Mean\_R & STD\_R \\
			\hline
			12 & 6 & 301 & 714 & 0.1143 & 0.0979 \\
			12 & 5 & 357 & 714 & 0.1236 & 0.0983 \\
			12 & 4 & 447 & 714 & 0.1444 & 0.1101 \\
			12 & 3 & 539 & 714 & 0.1672 & 0.1296 \\
			\hline
			20 & 4 & 253 & 714 & 0.1350 & 0.1112 \\
			12 & 4 & 447 & 714 & 0.1444 & 0.1101 \\
			7 & 4 & 691 & 714 & 0.1456 & 0.1079 \\
		\end{tabular}
		\end{center}
		\hfill {\footnotesize 73.1\% of the stars identified had a radial distance of less than 0.2 \textit{pixel length}} \\
		A general trend can be seen that higher the \textit{Threshold} or \textit{Star\_min\_pixel} value, higher the accuracy of the star identified, \textit{i.e.}, lower the values of \textit{Mean\_R} and \textit{STD\_R}. \\
		To further refine our results, we imposed a condition that the \textit{set radius} is 1.5 \textit{pixel lengths}. We noticed that none of the matched stars violated this condition. \\
		The Star Matching team only requires the coordinates of star centroids whose magnitude is lesser than 6. In our present star catalogue (in which the stars are ordered by their magnitude), this translates to a \textit{Star ID} of \textit{5060}. To filter out the dimmer stars, we used a trial and error method to arrive at the best possible combination of \textit{Threshold} and \textit{Star\_min\_pixel}. These results have been tabulated below:
		\begin{center}
		\begin{tabular}{ c|c|c|c|c|c }
			Threshold & Star\_min\_pixel & Num\_Id & Num\_Ac & Mean\_R & STD\_R \\
			\hline
			20 & 3 & 297 & 714 & 0.1488 & 0.1167 \\
			16 & 4 & 306 & 714 & 0.1296 & 0.1069 \\
			15 & 5 & 271 & 714 & 0.1177 & 0.0982 \\
			13 & 6 & 270 & 714 & 0.1080 & 0.0933 \\
		\end{tabular}
		\end{center}

		To improve the accuracy of our centroids, we tried two additional centroiding formulae\cite{zhang2011star} and the results for a \textit{Threshold} value of 20 and \textit{Star\_min\_pixel} value of 3 have been documented\footnote{where T is the Threshold value}\footnote{Mean and STD measured in pixel lengths}.
		\begin{center}
		\begin{tabular}{ c|c|c|c } 
			\textbf{Formula:} & \begin{math}  X = \frac{\sum{x_i w_i}}{\sum{w_i}} \end{math} & \begin{math}  X = \frac{\sum{x_i \left(w_i - T\right)}}{\sum{\left(w_i - T\right)}} \end{math} & \begin{math}  X = \frac{\sum{x_i \left(w_i - T\right)^2}}{\sum{\left(w_i - T\right)^2}} \end{math} \\ 
			 \textbf{Mean:} & 0.1488 & 0.1386 & 0.1804 \\ 
			 \textbf{Std:} & 0.1167 & 0.1267 & 0.1623 \\ 
		\end{tabular}
		\end{center}

		Some potential errors that could arise are:
		\begin{itemize}
			\item The centre of the coordinate plane may not be at the exact centre as the length and breadth of the image (in number of pixels) is generally even. This might be seen as a constant \emph{offset} in the comparison between code output and expected output
			\item While implementing the algorithm in C++, stack overflow will be a common problem as the sizes of the arrays involved are large
		\end{itemize}

%----------------------------END----------------------------%
\end{document}